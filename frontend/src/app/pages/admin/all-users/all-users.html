<!-- filter nav -->
<aside [class.open]="isFilterOpen">
  <img
    id="filter-close"
    class="btn-hover aside-close"
    src="/assets/close.png"
    (click)="isFilterOpen = !isFilterOpen"
    alt=""
  />

  <h3>Search Filter</h3>

  <div id="filter-filtering">
    <!-- Type -->
    <div>
      <label>Type</label>
      <div class="choose-both">
        <button
          class="btn-hover"
          [class.active]="type.includes('buyer')"
          (click)="filterSetUsertype('buyer')"
        >
          Buyer
        </button>
        <button
          class="btn-hover"
          [class.active]="type.includes('seller')"
          (click)="filterSetUsertype('seller')"
        >
          Seller
        </button>
      </div>
    </div>

    <!-- Age -->
    <div>
      <label>Age</label>
      <div>
        <input [(ngModel)]="ageA" type="number" min="0" placeholder="min" />
        <span>~</span>
        <input [(ngModel)]="ageB" type="number" min="0" placeholder="max" />
      </div>
    </div>

    <!-- Flat Count -->
    <div>
      <label>Flat Count</label>
      <div>
        <input [(ngModel)]="cntA" type="number" min="0" placeholder="min" />
        <span>~</span>
        <input [(ngModel)]="cntB" type="number" min="0" placeholder="max" />
      </div>
    </div>

    <!-- Is Admin -->
    <div>
      <label>Is Admin</label>
      <div class="choose-both">
        <button
          class="btn-hover"
          [class.active]="isAdmin === true"
          (click)="filterSetAdmin(true)"
        >
          Y
        </button>
        <button
          class="btn-hover"
          [class.active]="isAdmin === false"
          (click)="filterSetAdmin(false)"
        >
          N
        </button>
      </div>
    </div>
  </div>

  <!-- Sort -->
  <div id="filter-sort">
    <ng-container *ngFor="let option of sortOptions">
      <label>
        <input type="radio" [(ngModel)]="sort" [value]="option.value" />
        {{ option.label }}
      </label>
    </ng-container>
  </div>

  <!-- Actions -->
  <div id="filter-apply">
    <button type="button" (click)="filterReset()">Reset</button>
    <button type="button" (click)="filterApply()">Apply</button>
  </div>
</aside>

<!-- user title -->
<div id="user-control">
  <div id="title">
    Listing Users <span>({{ (filteredItems$ | async)?.length }})</span>
  </div>
  <button id="filter" class="btn-hover" (click)="isFilterOpen = !isFilterOpen">
    <img src="/assets/filter.png" alt="filter" />
    Filter
  </button>
</div>

<!-- user content -->
<ng-container *ngIf="filteredItems$ | async as filteredItems">
  <table *ngIf="filteredItems.length > 0; else noResult" class="user-wrap">
    <thead>
      <tr>
        <th>First Name</th>
        <th>Last Name</th>
        <th>Email</th>
        <th>User Type</th>
        <th>Birthdate(Age)</th>
        <th>Flat Counter</th>
        <th>Admin</th>
        <th>Manage</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let user of filteredItems; trackBy: trackById" class="user-item">
        <td>{{ user.firstname }}</td>
        <td>{{ user.lastname }}</td>
        <td>{{ user.email }}</td>
        <td>{{ user.type }}</td>
        <td>{{ user.birthdate | date:'yyyy.MM.dd' }} ({{ user.age }})</td>
        <td>{{ user.flats.length || 0 }}</td>
        <td>
          <div class="admin-manage">
            <p>{{ user.admin }}</p>
            <img
              class="btn-hover"
              src="/assets/change.png"
              alt="change admin"
              title="change admin"
              (click)="toggleAdmin(user)"
            />
          </div>
        </td>
        <td>
          <div class="user-manage">
            <button (click)="openUserProfile(user)">Profile</button>
            <button class="remove-manage" (click)="removeUser(user)">Remove</button>
          </div>
        </td>
      </tr>
    </tbody>
  </table>

  <ng-template #noResult>
    <div class="user-wrap">
      <p id="no-result">No results found. âœ…</p>
    </div>
  </ng-template>
</ng-container>
